import { NG_VALIDATORS, } from '@angular/forms';
import { Directive, Input } from '@angular/core';
import { electronicFormatIBAN, isValidIBAN } from 'ibantools';
import * as i0 from "@angular/core";
export const ibanValidator = (countryCode) => {
    return (control) => {
        if (countryCode && control.value) {
            return new RegExp(`^${countryCode}.*$`, 'i').test(control.value) &&
                isValidIBAN(electronicFormatIBAN(control.value))
                ? null
                : { iban: { value: control.value } };
        }
        else if (control.value) {
            return isValidIBAN(electronicFormatIBAN(control.value))
                ? null
                : { iban: { value: control.value } };
        }
        return null;
    };
};
export class IbanDirective {
    validate(control) {
        return ibanValidator(this.countryCode)(control);
    }
    /* istanbul ignore next */
    registerOnValidatorChange(fn) {
        this._onChange = fn;
    }
    /* istanbul ignore next */
    ngOnChanges(changes) {
        if ('countryCode' in changes && this._onChange) {
            this._onChange();
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.0.0", ngImport: i0, type: IbanDirective, deps: [], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "18.0.0", type: IbanDirective, isStandalone: true, selector: "[ngxIban]", inputs: { countryCode: ["ngxIban", "countryCode"] }, providers: [
            { provide: NG_VALIDATORS, useExisting: IbanDirective, multi: true },
        ], usesOnChanges: true, ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.0.0", ngImport: i0, type: IbanDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[ngxIban]',
                    standalone: true,
                    providers: [
                        { provide: NG_VALIDATORS, useExisting: IbanDirective, multi: true },
                    ],
                }]
        }], propDecorators: { countryCode: [{
                type: Input,
                args: ['ngxIban']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWJhbi5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9uZ3gtaWJhbi9zcmMvbGliL25neC1pYmFuL2liYW4uZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCxhQUFhLEdBSWQsTUFBTSxnQkFBZ0IsQ0FBQztBQUN4QixPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBNEIsTUFBTSxlQUFlLENBQUM7QUFDM0UsT0FBTyxFQUFFLG9CQUFvQixFQUFFLFdBQVcsRUFBRSxNQUFNLFdBQVcsQ0FBQzs7QUFFOUQsTUFBTSxDQUFDLE1BQU0sYUFBYSxHQUEwQyxDQUNsRSxXQUFXLEVBQ1gsRUFBRTtJQUNGLE9BQU8sQ0FBQyxPQUF3QixFQUEyQixFQUFFO1FBQzNELElBQUksV0FBVyxJQUFJLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNqQyxPQUFPLElBQUksTUFBTSxDQUFDLElBQUksV0FBVyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUM7Z0JBQzlELFdBQVcsQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFFLENBQUM7Z0JBQ2pELENBQUMsQ0FBQyxJQUFJO2dCQUNOLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQztRQUN6QyxDQUFDO2FBQU0sSUFBSSxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDekIsT0FBTyxXQUFXLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBRSxDQUFDO2dCQUN0RCxDQUFDLENBQUMsSUFBSTtnQkFDTixDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUM7UUFDekMsQ0FBQztRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBU0YsTUFBTSxPQUFPLGFBQWE7SUFJeEIsUUFBUSxDQUFDLE9BQXdCO1FBQy9CLE9BQU8sYUFBYSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNsRCxDQUFDO0lBRUQsMEJBQTBCO0lBQzFCLHlCQUF5QixDQUFDLEVBQWM7UUFDdEMsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7SUFDdEIsQ0FBQztJQUVELDBCQUEwQjtJQUMxQixXQUFXLENBQUMsT0FBc0I7UUFDaEMsSUFBSSxhQUFhLElBQUksT0FBTyxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztZQUMvQyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7UUFDbkIsQ0FBQztJQUNILENBQUM7OEdBbEJVLGFBQWE7a0dBQWIsYUFBYSw2R0FKYjtZQUNULEVBQUUsT0FBTyxFQUFFLGFBQWEsRUFBRSxXQUFXLEVBQUUsYUFBYSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUU7U0FDcEU7OzJGQUVVLGFBQWE7a0JBUHpCLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLFdBQVc7b0JBQ3JCLFVBQVUsRUFBRSxJQUFJO29CQUNoQixTQUFTLEVBQUU7d0JBQ1QsRUFBRSxPQUFPLEVBQUUsYUFBYSxFQUFFLFdBQVcsZUFBZSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUU7cUJBQ3BFO2lCQUNGOzhCQUVtQixXQUFXO3NCQUE1QixLQUFLO3VCQUFDLFNBQVMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBYnN0cmFjdENvbnRyb2wsXG4gIE5HX1ZBTElEQVRPUlMsXG4gIFZhbGlkYXRpb25FcnJvcnMsXG4gIFZhbGlkYXRvcixcbiAgVmFsaWRhdG9yRm4sXG59IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IERpcmVjdGl2ZSwgSW5wdXQsIE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZWxlY3Ryb25pY0Zvcm1hdElCQU4sIGlzVmFsaWRJQkFOIH0gZnJvbSAnaWJhbnRvb2xzJztcblxuZXhwb3J0IGNvbnN0IGliYW5WYWxpZGF0b3I6IChjb3VudHJ5Q29kZT86IHN0cmluZykgPT4gVmFsaWRhdG9yRm4gPSAoXG4gIGNvdW50cnlDb2RlXG4pID0+IHtcbiAgcmV0dXJuIChjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCA9PiB7XG4gICAgaWYgKGNvdW50cnlDb2RlICYmIGNvbnRyb2wudmFsdWUpIHtcbiAgICAgIHJldHVybiBuZXcgUmVnRXhwKGBeJHtjb3VudHJ5Q29kZX0uKiRgLCAnaScpLnRlc3QoY29udHJvbC52YWx1ZSkgJiZcbiAgICAgICAgaXNWYWxpZElCQU4oZWxlY3Ryb25pY0Zvcm1hdElCQU4oY29udHJvbC52YWx1ZSkhKVxuICAgICAgICA/IG51bGxcbiAgICAgICAgOiB7IGliYW46IHsgdmFsdWU6IGNvbnRyb2wudmFsdWUgfSB9O1xuICAgIH0gZWxzZSBpZiAoY29udHJvbC52YWx1ZSkge1xuICAgICAgcmV0dXJuIGlzVmFsaWRJQkFOKGVsZWN0cm9uaWNGb3JtYXRJQkFOKGNvbnRyb2wudmFsdWUpISlcbiAgICAgICAgPyBudWxsXG4gICAgICAgIDogeyBpYmFuOiB7IHZhbHVlOiBjb250cm9sLnZhbHVlIH0gfTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG59O1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbbmd4SWJhbl0nLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBwcm92aWRlcnM6IFtcbiAgICB7IHByb3ZpZGU6IE5HX1ZBTElEQVRPUlMsIHVzZUV4aXN0aW5nOiBJYmFuRGlyZWN0aXZlLCBtdWx0aTogdHJ1ZSB9LFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBJYmFuRGlyZWN0aXZlIGltcGxlbWVudHMgVmFsaWRhdG9yLCBPbkNoYW5nZXMge1xuICBASW5wdXQoJ25neEliYW4nKSBjb3VudHJ5Q29kZT86IHN0cmluZztcbiAgcHJpdmF0ZSBfb25DaGFuZ2U/OiAoKSA9PiB2b2lkO1xuXG4gIHZhbGlkYXRlKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IFZhbGlkYXRpb25FcnJvcnMgfCBudWxsIHtcbiAgICByZXR1cm4gaWJhblZhbGlkYXRvcih0aGlzLmNvdW50cnlDb2RlKShjb250cm9sKTtcbiAgfVxuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gIHJlZ2lzdGVyT25WYWxpZGF0b3JDaGFuZ2UoZm46ICgpID0+IHZvaWQpIHtcbiAgICB0aGlzLl9vbkNoYW5nZSA9IGZuO1xuICB9XG5cbiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGlmICgnY291bnRyeUNvZGUnIGluIGNoYW5nZXMgJiYgdGhpcy5fb25DaGFuZ2UpIHtcbiAgICAgIHRoaXMuX29uQ2hhbmdlKCk7XG4gICAgfVxuICB9XG59XG4iXX0=